<UserControl x:Class="TheMovies.MVVM.View.BookingView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:TheMovies.MVVM.View"
             xmlns:viewModel="clr-namespace:TheMovies.MVVM.ViewModel"
             mc:Ignorable="d" 
             d:DesignHeight="1000" d:DesignWidth="1000">

    <UserControl.DataContext>
        <viewModel:BookingViewModel/>
    </UserControl.DataContext>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="50*"/>
            <RowDefinition Height="50*"/>
        </Grid.RowDefinitions>

        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="50*"/>
            <ColumnDefinition Width="50*"/>
        </Grid.ColumnDefinitions>

        <!-- Vælg forestilling fra oversigten -->
        <GroupBox Header="Forestillinger"
                  Foreground="AliceBlue"
                  FontSize="16"
                  Margin="10">
            <!-- Listen kan scrolle, hvis den bliver lang -->
            <ScrollViewer HorizontalScrollBarVisibility="Auto">
                <!-- Listbox oversigt over MovieScreeningCollection -->
                <ListBox ItemsSource="{Binding MovieScreeningsCollectionView, UpdateSourceTrigger=PropertyChanged}"
                         SelectedItem="{Binding SelectedMovieScreening, UpdateSourceTrigger=PropertyChanged}"
                         Background="Transparent"
                         BorderThickness="0">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="5" Orientation="Vertical">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="{Binding Path=MovieProgram.Movie.title, UpdateSourceTrigger=PropertyChanged}" 
                                       FontWeight="Bold" Foreground="AliceBlue"/>
                                    <TextBlock Text="{Binding Path=MovieScreeningDateTime, UpdateSourceTrigger=PropertyChanged}" 
                                       Foreground="AliceBlue"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Ledige billetter: "
                                        Foreground="AliceBlue"/>
                                    <TextBlock Text="{Binding Path=AvailableTickets, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}" 
                                        Foreground="AliceBlue"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Path=MovieProgram.Hall.Cinema.Name, UpdateSourceTrigger=PropertyChanged}"
                                           Foreground="AliceBlue"/>
                                    <TextBlock Text=", " Foreground="AliceBlue"/>
                                    <TextBlock Text="{Binding Path=MovieProgram.Hall.Cinema.City, UpdateSourceTrigger=PropertyChanged}"
                                           Foreground="AliceBlue"/>
                                    <TextBlock Text=", " Foreground="AliceBlue"/>
                                    <TextBlock Text="{Binding Path=MovieProgram.Hall.Name, UpdateSourceTrigger=PropertyChanged}"
                                       Foreground="AliceBlue"/>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </ScrollViewer>
        </GroupBox>

        <!-- Opret booking -->
        <GroupBox Grid.Column="1" Header="Tilføj booking"
                  FontSize="16" Foreground="AliceBlue"
                  BorderThickness="0.8">
            <ScrollViewer VerticalScrollBarVisibility="Auto">              
            <StackPanel Orientation="Vertical" Margin="10">

                <!-- Felt til angivelse af billetantal -->
                <StackPanel Margin="0 20 0 0" Orientation="Horizontal">
                    <Label Content="Angiv billetantal: "
                           Foreground="AliceBlue" FontSize="16"/>
                    <TextBox Text="{Binding TicketCount, UpdateSourceTrigger=PropertyChanged}"
                               Background="AliceBlue"
                               Width="50" HorizontalAlignment="Left"/>
                </StackPanel>

                <!-- Angivelse af kundeoplysninger -->
                <StackPanel Margin="0 10 0 15">
                    <Label Content="Navn:" Foreground="AliceBlue"/>
                    <TextBox Text="{Binding Name, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>

                    <Label Content="Email:" Foreground="AliceBlue"/>
                    <TextBox Text="{Binding Email, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>

                    <Label Content="Telefonnr.:" Foreground="AliceBlue"/>
                    <TextBox Text="{Binding PhoneNumber, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>

                    <!-- Tilføj knap -->
                    <Button Content="Tilføj"
                            Command="{Binding AddBookingCommand, UpdateSourceTrigger=PropertyChanged}"
                            Width="90" Height="30" Margin="0,10,0,0"
                            HorizontalAlignment="Left"/>
                </StackPanel>
            </StackPanel>
            </ScrollViewer>
        </GroupBox>

        <!-- Vælg Booking fra oversigten -->
        <GroupBox Grid.Row="1" 
                  Header="Bookinger"
                  Foreground="AliceBlue"
                  FontSize="16"
                  Margin="10">
            <!-- Listen kan scrolle, hvis den bliver lang -->
            <ScrollViewer HorizontalScrollBarVisibility="Auto">
                <!-- Listbox oversigt over MovieScreeningCollection -->
                <ListBox ItemsSource="{Binding BookingsCollectionView, UpdateSourceTrigger=PropertyChanged}"
                  SelectedItem="{Binding SelectedBooking, UpdateSourceTrigger=PropertyChanged}"
                  Background="Transparent"
                  BorderThickness="0">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Margin="5" Orientation="Vertical">
                                <StackPanel Orientation="Vertical">
                                    <TextBlock Text="{Binding Path=Customer.Name, UpdateSourceTrigger=PropertyChanged}" 
                                FontWeight="Bold" Foreground="AliceBlue"/>
                                    <TextBlock Text="{Binding Path=Customer.Email, UpdateSourceTrigger=PropertyChanged}" 
                                Foreground="AliceBlue"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="Antal billetter: "
                                 Foreground="AliceBlue"/>
                                    <TextBlock Text="{Binding Path=TicketCount, UpdateSourceTrigger=PropertyChanged}" 
                                 Foreground="AliceBlue"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding Path=MovieScreening.MovieProgram.Movie.title, UpdateSourceTrigger=PropertyChanged}"
                                    Foreground="AliceBlue"/>
                                    <TextBlock Text=", " Foreground="AliceBlue"/>
                                    <TextBlock Text="{Binding Path=MovieScreening.MovieScreeningDateTime, UpdateSourceTrigger=PropertyChanged}"
                                    Foreground="AliceBlue"/>
                                    <TextBlock Text=", " Foreground="AliceBlue"/>
                                    <TextBlock Text="{Binding Path=Date, UpdateSourceTrigger=PropertyChanged}"
                                Foreground="AliceBlue"/>
                                </StackPanel>
                            </StackPanel>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </ScrollViewer>
        </GroupBox>

        <StackPanel Grid.Row="1" Grid.Column="1">
            
            <GroupBox Header="Søg i bookinger" 
                      Foreground="AliceBlue" 
                      FontSize="16">

                <TextBox Text="{Binding SearchTerm, UpdateSourceTrigger=PropertyChanged}"
                         Background="Transparent"
                         Foreground="AliceBlue"
                         BorderThickness="0"
                         CaretBrush="AliceBlue"/>
            </GroupBox>
            
            <!-- Opdater/fjern booking -->
            <GroupBox Header="Opdater/fjern booking"
                      FontSize="16" 
                      Foreground="AliceBlue">
                <ScrollViewer VerticalScrollBarVisibility="Auto">

                    <StackPanel Orientation="Vertical">


                        <!-- Felt til angivelse af billetantal -->
                        <StackPanel Margin="0 20 0 0" Orientation="Horizontal">
                            <Label Content="Billetantal: "
                   Foreground="AliceBlue" FontSize="16"/>
                            <TextBox Text="{Binding SelectedBooking.TicketCount, UpdateSourceTrigger=PropertyChanged}"
                       Background="AliceBlue"
                       Width="50" HorizontalAlignment="Left"/>
                        </StackPanel>

                        <StackPanel Margin="0 10 0 -10">
                            <Label Content="Navn:" Foreground="AliceBlue"/>
                            <TextBox Text="{Binding SelectedBooking.Customer.Name, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>

                            <Label Content="Email:" Foreground="AliceBlue"/>
                            <TextBox Text="{Binding SelectedBooking.Customer.Email, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>

                            <Label Content="Telefonnr.:" Foreground="AliceBlue"/>
                            <TextBox Text="{Binding SelectedBooking.Customer.Phone,UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"/>

                            <StackPanel Orientation="Horizontal" HorizontalAlignment="Left" Margin="0,10,0,0">
                                <Button Content="Opdater"
                        Command="{Binding UpdateBookingCommand, UpdateSourceTrigger=PropertyChanged}"
                        Width="100"/>

                                <Button Content="Fjern"
                        Command="{Binding RemoveBookingCommand, UpdateSourceTrigger=PropertyChanged}"
                        Margin="10,0,0,0"  Width="100"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>
            </GroupBox>
        </StackPanel>       
    </Grid>
</UserControl>
    
 